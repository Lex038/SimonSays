<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Simon Says Mysterie</title>
<style>
  body {
    font-family: 'Trebuchet MS', sans-serif;
    background: radial-gradient(circle at center, #0b0b0b 0%, #000 100%);
    color: #eee;
    text-align: center;
    margin: 0;
    overflow-x: hidden;
    transition: transform 0.1s;
  }

  /* ----------------- Schermtrilling ----------------- */
  .shake-screen {
    animation: screenShake 0.6s ease;
  }
  @keyframes screenShake {
    0% { transform: translate(0,0); }
    20% { transform: translate(-10px,5px); }
    40% { transform: translate(8px,-8px); }
    60% { transform: translate(-5px,5px); }
    80% { transform: translate(5px,-3px); }
    100% { transform: translate(0,0); }
  }

  /* ----------------- Wachtwoord ----------------- */
  #password-screen {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: radial-gradient(circle at 50% 40%, #1a1a1a, #000);
    box-shadow: inset 0 0 100px #000;
    z-index: 10;
    transition: opacity 1.5s ease, transform 1.5s ease, filter 1.5s ease;
  }
  #password-screen.fade-out {
    opacity: 0;
    transform: scale(1.2);
    filter: blur(3px);
  }
  #password-screen h1 {
    font-size: 2em;
    color: #74b9ff;
    text-shadow: 0 0 10px #0984e3;
  }
  #password-screen input {
    padding: 10px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    outline: none;
    margin: 10px 0;
    width: 200px;
    text-align: center;
    background: #222;
    color: #eee;
    box-shadow: 0 0 10px rgba(116,185,255,0.3);
  }
  #password-screen button {
    padding: 10px 20px;
    font-size: 16px;
    background: #0984e3;
    border: none;
    border-radius: 8px;
    color: white;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s;
  }
  #password-screen button:hover {
    background: #74b9ff;
    transform: scale(1.05);
  }
  #password-error {
    color: #ff7675;
    margin-top: 10px;
    display: none;
    font-size: 1.1em;
    text-shadow: 0 0 4px #ff0000;
  }

  /* ----------------- RODE FLITS ----------------- */
  #red-flash {
    position: fixed;
    inset: 0;
    background: rgba(255,0,0,0.2);
    opacity: 0;
    pointer-events: none;
    z-index: 9999;
  }
  #red-flash.active {
    animation: redFlash 0.4s;
  }
  @keyframes redFlash {
    0% { opacity: 0.7; filter: blur(2px); }
    50% { opacity: 0.8; filter: blur(1px); }
    100% { opacity: 0; filter: blur(0); }
  }

  /* ----------------- PORTAAL ----------------- */
  #portal {
    position: fixed;
    top:50%;
    left:50%;
    width:100px;
    height:100px;
    border:4px solid rgba(116,185,255,0.6);
    border-radius:50%;
    transform:translate(-50%,-50%) scale(0);
    box-shadow:0 0 20px 10px rgba(116,185,255,0.6);
    z-index:50;
    pointer-events:none;
    opacity:0;
  }
  #portal.active {
    animation: openPortal 2s forwards;
  }
  @keyframes openPortal {
    0% { transform: translate(-50%,-50%) scale(0); opacity:0; }
    30% { transform: translate(-50%,-50%) scale(1.2); opacity:1; }
    60% { transform: translate(-50%,-50%) scale(1.8) rotate(180deg); opacity:0.9; }
    100% { transform: translate(-50%,-50%) scale(3) rotate(360deg); opacity:0; }
  }

  /* ----------------- Energie-wave ----------------- */
  #energy-wave {
    position: fixed;
    inset:0;
    background: radial-gradient(circle at 50% 50%, rgba(0,200,255,0.25), transparent 70%);
    opacity:0;
    pointer-events:none;
    z-index:40;
  }
  #energy-wave.active {
    animation: energySweep 1.5s ease-out forwards;
  }
  @keyframes energySweep {
    0% { transform: scale(0.5); opacity:0; }
    30% { transform: scale(1.2); opacity:0.6; }
    60% { transform: scale(2); opacity:0.4; }
    100% { transform: scale(3.5); opacity:0; }
  }

  /* ----------------- SPEL ----------------- */
  #game-container { display:none; padding-top:20px; }
  #game {
    display:grid;
    grid-template-columns:repeat(2,150px);
    grid-template-rows:repeat(2,150px);
    gap:15px;
    justify-content:center;
    margin:30px auto;
  }
  .btn {
    width:150px;
    height:150px;
    opacity:0.8;
    border-radius:15px;
    transition:transform 0.2s, opacity 0.2s, box-shadow 0.2s;
    cursor:pointer;
  }
  #green { background:#00b894; }
  #red { background:#d63031; }
  #yellow { background:#fdcb6e; }
  #blue { background:#0984e3; }
  .btn.active {
    opacity:1 !important;
    transform:scale(1.1);
    box-shadow:0 0 25px rgba(255,255,255,0.9);
  }
  #progress {
    width:80%;
    height:20px;
    background:#333;
    border-radius:10px;
    margin:15px auto;
    overflow:hidden;
  }
  #progress-bar {
    height:100%;
    width:0;
    background:linear-gradient(90deg, #00b894, #0984e3);
    transition: width 0.3s;
  }

  /* ----------------- SPRANKELENDE TEKST ----------------- */
  #status.sparkle {
    animation: sparkleText 2s infinite alternate;
    color:#fff;
    text-shadow:
      0 0 5px #00eaff,
      0 0 10px #00eaff,
      0 0 20px #00eaff,
      0 0 40px #00ffff;
  }
  @keyframes sparkleText {
    from { opacity:0.7; filter:hue-rotate(0deg); }
    to { opacity:1; filter:hue-rotate(360deg); }
  }
</style>
</head>
<body>
<div id="red-flash"></div>
<div id="portal"></div>
<div id="energy-wave"></div>

<!-- Wachtwoord -->
<div id="password-screen">
  <h1>Toegang vereist</h1>
  <p>Voer het wachtwoord in om te spelen:</p>
  <input type="password" id="password-input" placeholder="Wachtwoord">
  <button onclick="checkPassword()">Verder</button>
  <p id="password-error">❌ Onjuist wachtwoord</p>
</div>

<!-- Spel -->
<div id="game-container">
  <h1>Simon Says</h1>
  <div id="game">
    <div id="green" class="btn"></div>
    <div id="red" class="btn"></div>
    <div id="yellow" class="btn"></div>
    <div id="blue" class="btn"></div>
  </div>
  <button onclick="startGame()">▶️ Start</button>
  <div id="progress"><div id="progress-bar"></div></div>
  <div id="status">Druk op Start om te beginnen</div>
</div>

<script>
const correctPassword="noordkromp";
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();

const buttons=["green","red","yellow","blue"];
let sequence=[], playerSequence=[], level=0, gameActive=false;
const goalLevel=18;
const sounds={green:440, red:523.25, yellow:659.26, blue:830.61};
const waveforms={green:"sine", red:"square", yellow:"triangle", blue:"sawtooth"};

function checkPassword(){
  const input=document.getElementById("password-input");
  const error=document.getElementById("password-error");
  const flash=document.getElementById("red-flash");
  const portal=document.getElementById("portal");
  const wave=document.getElementById("energy-wave");

  if(input.value.trim().toLowerCase()===correctPassword){
    playPortalSound();
    navigator.vibrate([200,100,200,100,200]);
    document.body.classList.add("shake-screen");
    wave.classList.add("active");
    portal.classList.add("active");

    const screen=document.getElementById("password-screen");
    screen.classList.add("fade-out");

    setTimeout(()=>{
      document.body.classList.remove("shake-screen");
      wave.classList.remove("active");
      screen.style.display="none";
      portal.classList.remove("active");
      document.getElementById("game-container").style.display="block";
      document.getElementById("game-container").scrollIntoView({behavior:"smooth"});
    },1800);
  } else {
    playCreepyError();
    navigator.vibrate([120]);
    flash.classList.add("active");
    error.style.display="block";
    setTimeout(()=>flash.classList.remove("active"),600);
  }
}

/* ----------------- Geluiden ----------------- */
function playPortalSound(){
  const now=audioCtx.currentTime;
  const osc=audioCtx.createOscillator();
  const gain=audioCtx.createGain();
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.type="sine";
  osc.frequency.setValueAtTime(100,now);
  osc.frequency.exponentialRampToValueAtTime(900,now+1.5);
  gain.gain.setValueAtTime(0.3,now);
  gain.gain.exponentialRampToValueAtTime(0.001,now+1.8);
  osc.start(now);
  osc.stop(now+1.8);
}

function playCreepyError(){
  if(audioCtx.state==="suspended") audioCtx.resume();
  const now=audioCtx.currentTime;
  for(let i=0;i<6;i++){
    const osc=audioCtx.createOscillator();
    const gain=audioCtx.createGain();
    osc.connect(gain); gain.connect(audioCtx.destination);
    osc.type="sawtooth";
    osc.frequency.setValueAtTime(100+Math.random()*200, now+i*0.05);
    gain.gain.setValueAtTime(0.2, now+i*0.05);
    gain.gain.exponentialRampToValueAtTime(0.001, now+i*0.05+0.2);
    osc.start(now+i*0.05);
    osc.stop(now+i*0.05+0.2);
  }
}

function playGameError(){
  if(audioCtx.state==="suspended") audioCtx.resume();
  const now=audioCtx.currentTime;
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.connect(g); g.connect(audioCtx.destination);
  o.type="sawtooth";
  o.frequency.setValueAtTime(120,now);
  o.frequency.exponentialRampToValueAtTime(60,now+0.3);
  g.gain.setValueAtTime(0.3,now);
  g.gain.exponentialRampToValueAtTime(0.001,now+0.3);
  o.start(now); o.stop(now+0.3);
}

function playVictorySound(){
  const now=audioCtx.currentTime;
  const freqs=[440,523.25,659.25];
  freqs.forEach((f,i)=>{
    const o=audioCtx.createOscillator();
    const g=audioCtx.createGain();
    o.type="triangle"; o.frequency.setValueAtTime(f,now+i*0.1);
    g.gain.setValueAtTime(0.2,now+i*0.1);
    g.gain.exponentialRampToValueAtTime(0.001, now+i*0.6);
    o.connect(g).connect(audioCtx.destination);
    o.start(now+i*0.1); o.stop(now+i*0.6);
  });
}

/* ----------------- Simon Says ----------------- */
function playSound(color){
  if(audioCtx.state==="suspended") audioCtx.resume();
  const osc=audioCtx.createOscillator();
  const gain=audioCtx.createGain();
  osc.connect(gain); gain.connect(audioCtx.destination);
  osc.type=waveforms[color]; osc.frequency.value=sounds[color];
  osc.start();
  gain.gain.setValueAtTime(0.2,audioCtx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+0.6);
  osc.stop(audioCtx.currentTime+0.6);
}

function startGame(){
  sequence=[]; playerSequence=[]; level=0; gameActive=true;
  updateProgress(); nextRound();
}

function nextRound(){
  if(!gameActive) return;
  playerSequence=[]; level++;
  document.getElementById("status").textContent="Level "+level;
  updateProgress();

  if(level>goalLevel){
    gameActive=false;
    playVictorySound();
    navigator.vibrate([100,100,100,300]);
    const st=document.getElementById("status");
    st.textContent="Je hebt het raadsel onthuld!";
    st.classList.add("sparkle");
    alert("Wanneer de klok negen slaat en avond in het duister baadt,\nverschijnt de haan met vurig kam, die waakt waar voor hem stilte kwam.\nWie hem ontmoet op 't uur der nacht, zal dragen last tot morgengracht.");
    return;
  }

  const nextColor=buttons[Math.floor(Math.random()*4)];
  sequence.push(nextColor);
  playSequence();
}

function playSequence(){
  let i=0;
  const interval=setInterval(()=>{
    highlight(sequence[i]); playSound(sequence[i]); i++;
    if(i>=sequence.length) clearInterval(interval);
  }, 500);
}

function highlight(color){
  const el=document.getElementById(color);
  el.classList.add("active");
  setTimeout(()=>el.classList.remove("active"),500);
}

document.querySelectorAll(".btn").forEach(btn=>{
  btn.addEventListener("click",e=>{
    if(!gameActive) return;
    const color=e.target.id;
    playerSequence.push(color);
    highlight(color);
    playSound(color);
    checkInput();
  });
});

function checkInput(){
  const idx=playerSequence.length-1;
  if(playerSequence[idx]!==sequence[idx]){
    document.getElementById("status").textContent="❌ Fout! Probeer opnieuw.";
    playGameError();
    navigator.vibrate([120,80,120]);
    gameActive=false;
    return;
  }
  if(playerSequence.length===sequence.length){
    setTimeout(nextRound,800);
  }
}

function updateProgress(){
  const progress=Math.min(level/goalLevel*100,100);
  document.getElementById("progress-bar").style.width=progress+"%";
}
</script>
</body>
</html>
